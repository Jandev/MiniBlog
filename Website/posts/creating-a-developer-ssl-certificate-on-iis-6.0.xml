<?xml version="1.0" encoding="utf-8"?>
<post>
  <title>Creating a developer SSL certificate on IIS 6.0</title>
  <slug>creating-a-developer-ssl-certificate-on-iis-6.0</slug>
  <author>Jan</author>
  <pubDate>2011-05-14 20:09:26</pubDate>
  <lastModified>2014-04-25 12:06:07</lastModified>
  <content>&lt;p&gt;It’s one of those things you need to do once and forget about it. Sometimes it’s necessary to develop something which required talking to a webservice. A lot of the times, the webservice is secured with an SSL certificate in the real world. &lt;/p&gt; &lt;p&gt;As most companies don’t want to spend good money to real SSL certificates for development workstations/servers, we have to create our own. You can of course develop the functionality with a non-secured environment, but for testing purposes it’s probably useful to have the test environment match the QA or production servers.&lt;/p&gt; &lt;p&gt;A while back I had an issue in some production software. We discovered something was malfunctioning I was needed to figure out what was wrong. As the code hadn’t changed in quite some time and it appeared the code was good (enough), I started looking at the infrastructure and discovered it might have something to do with the webservice (in SSL) it was talking to. As I couldn’t connect to the production environment, I had to connect to a local service which was running in SSL, so I did.&lt;/p&gt; &lt;p&gt;If you want to do this, you need to take quite some steps if you are running on IIS 6.0. This feature has improved a lot IIS 7.0/7.5. ScotGu has &lt;a href="http://weblogs.asp.net/scottgu/archive/2007/04/06/tip-trick-enabling-ssl-on-iis7-using-self-signed-certificates.aspx"&gt;written a nice walkthough&lt;/a&gt; about this. Just hit the &lt;em&gt;Create Self-Signed Certificate&lt;/em&gt; link and you are done. Too bad I was still developing in an IIS 6.0 environment (Windows 2003R2). I’ll describe the needed steps below.&lt;/p&gt; &lt;p&gt;The first thing which needs to be done is downloading the &lt;a href="http://support.microsoft.com/kb/840671"&gt;IIS 6.0 Resource Kit Tools&lt;/a&gt;. This doesn’t appear to be a big problem, but for me it was. I had found a lot of pages linking to the kit, but all of them were dead. After finally having found the &lt;a href="http://www.microsoft.com/downloads/en/details.aspx?FamilyID=56fc92ee-a71a-4c73-b628-ade629c89499&amp;amp;displaylang=en"&gt;correct link&lt;/a&gt; I was good to go and installed the needed &lt;a href="http://support.microsoft.com/kb/840671#11"&gt;SelfSSL&lt;/a&gt; application.&lt;/p&gt; &lt;p&gt;The tool comes with a decent help which you can check by typing &lt;em&gt;selfssl /?&lt;/em&gt; in the command prompt. As we need to add a self-signed certificate to a website in IIS on a specific port number, we need the arguments /T, /S and /P. The values we need can be found in IIS Manager. The site ID and port number is specified in the overview of the websites:&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_2.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_thumb.png" width="570" height="28"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;In this case the site ID is 165159687 and the SSL port number we want to use is 82. The command we need to use will look like this:&lt;/p&gt; &lt;p&gt;&lt;font style="background-color: #000000" color="#ffffff" face="Courier New"&gt;selfssl /T /S:165159687 /P:82&lt;/font&gt;&lt;/p&gt; &lt;p&gt;Now the certificate is in place and you can visit the secured website in the browser. Once there you’ll see a message, something like this (depending on the browser) &lt;br&gt;&lt;em&gt;(note: the following steps are also needed if you are running on the IIS7.0 webserver and are optional)&lt;/em&gt;:&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_4.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_thumb_1.png" width="579" height="246"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;As this is our development site we can safely choose &lt;em&gt;Continue on this website (not recommended)&lt;/em&gt;. Once we are on the website you can see a small message next to the address bar stating there’s a &lt;em&gt;Certificate Error&lt;/em&gt;.&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_6.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_thumb_2.png" width="175" height="54"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;You can click on this message and a popup will appear.&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_8.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_thumb_3.png" width="254" height="265"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;By clicking the link &lt;em&gt;View certificates&lt;/em&gt; you can add the certificate to your local store so this error won’t be shown again. The following popup will appear:&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_10.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_thumb_4.png" width="296" height="346"&gt;&lt;/a&gt;&lt;br&gt;&lt;em&gt;(machine name and dates will vary)&lt;/em&gt;&lt;/p&gt; &lt;p&gt;If you want you can check some of the details in this popup, but as we know this is all good we can just click the &lt;em&gt;Install Certificate&lt;/em&gt; button in the lower corner.&lt;/p&gt; &lt;p&gt;Stepping through the wizard you will get the option to place the certificate in a store. I first tried out the &lt;em&gt;Automatically select….&lt;/em&gt;, but that didn’t have the desired effect. After that I’ve tried the Personal store, but that didn’t help much either. After having tried those two options, I’ve placed the certificate in the &lt;em&gt;Trusted Root Certification Authorities&lt;/em&gt;.&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_12.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/Creating-a-developer-SSL-certificate_12CEE/image_thumb_5.png" width="399" height="131"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;This had the desired effect, I could check the local SSL webservice without the annoying warning messages. With everything up and running the code could be debugged to check it was working properly with an SSL webservice. Lucky for me, it did, so I had to look for another solution for the problem.&lt;/p&gt;     &lt;p&gt;Remember, only apply the above steps if you know you can trust the certificate. Don’t add certificates from the web from ‘fishy’ sites. It can cause a lot of problems to you and your computer.&lt;/p&gt;</content>
  <ispublished>true</ispublished>
  <categories></categories>
  <comments></comments>
</post>