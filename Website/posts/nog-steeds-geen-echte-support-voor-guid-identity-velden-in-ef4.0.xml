<?xml version="1.0" encoding="utf-8"?>
<post>
  <title>Nog steeds geen echte support voor GUID identity velden in EF4.0</title>
  <slug>nog-steeds-geen-echte-support-voor-guid-identity-velden-in-ef4.0</slug>
  <author>Jan</author>
  <pubDate>2010-04-21 14:22:00</pubDate>
  <lastModified>2014-04-25 12:06:08</lastModified>
  <content>&lt;div class="ExternalClassB94ABBCE867640FEAB781AAAF2D7F8A0"&gt;
&lt;p&gt;In m'n database maak ik gebruik van een idenity veld dat bestaat uit een Guid. Deze guid wordt automatisch gegenereerd binnen SQL Server door middel van de &lt;span style="font-family: Courier New;"&gt;newsequentialid()&lt;/span&gt; functie (dit kan uiteraard ook met &lt;span style="font-family: Courier New;"&gt;newid()&lt;/span&gt;). Dit betekend dus dat ik in m'n code niet een guid hoef aan te maken, omdat SQL dit al zelf doet. In de op te slaan entity vul ik het ID veld dus ook niet.&lt;/p&gt;
&lt;p&gt;Nadat het insert commando is uitgevoerd verwachtte ik dat het ID veld zou worden gevuld met de nieuw aangemaakte guid, maar niets is minder waar. Het blijft een Guid.Empty (&lt;em&gt;00000000-0000-0000-0000-000000000000&lt;/em&gt;). In het EF1.0 werkte dit inderdaad niet, daar was helemaal geen support voor Guid identity velden. Er was echter beloofd om dit wel op te lossen in het EF4.0. Na een kleine zoektocht kom ik op allerlei pagina's en sites die het hebben over EF1.0 en Linq-to-Sql, iets waar ik in het verleden ook al dit probleem heb gehad.&lt;/p&gt;
&lt;p&gt;Met de ervaring die ik uit het verleden had, heb ik ook al even zelf zitten klikken en zag dat de &lt;em&gt;StoreGeneratedPattern&lt;/em&gt; op &lt;em&gt;None&lt;/em&gt; stond. Deze heb ik op &lt;em&gt;Identity&lt;/em&gt; en op &lt;em&gt;Computed&lt;/em&gt; gezet. Beide keren was dit niet de oplossing.&lt;/p&gt;
&lt;p&gt;&lt;img src="http://weblogjanv/Lists/Photos/060910_1220_Nogsteedsge1.png" alt="" /&gt;&lt;/p&gt;
&lt;p&gt;Uiteindelijk ben ik op een post van Lee Dumond uitgekomen: &lt;a href="http://leedumond.com/blog/using-a-guid-as-an-entitykey-in-entity-framework-4/"&gt;http://leedumond.com/blog/using-a-guid-as-an-entitykey-in-entity-framework-4/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Hier loopt hij tegen hetzelfde probleem aan als mij.&lt;/p&gt;
&lt;p&gt;Hij heeft hier de oplossing beschreven, namelijk dat je zelf, &lt;strong&gt;handmatig&lt;/strong&gt;, de XML van het edmx-bestand moet aanpassen en dan bij het veld instellen dat dit een Identity veld is.&lt;/p&gt;
&lt;p&gt;In de edmx:StorageModels moet je zelf bij het juiste veld aangeven dat deze automatisch wordt aangemaakt:&lt;/p&gt;
&lt;p style="background: white;"&gt;&lt;span style="font-family: Consolas; color: blue; font-size: 8pt;"&gt;&amp;lt;&lt;span style="color: #a31515;"&gt;edmx:StorageModels&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="background: white;"&gt;&lt;span style="font-family: Consolas; font-size: 8pt;"&gt;&lt;span style="color: blue;"&gt;&amp;hellip;&amp;hellip;&lt;/span&gt; &lt;/span&gt;&lt;/p&gt;
&lt;p style="background: white;"&gt;&lt;span style="font-family: Consolas; color: blue; font-size: 8pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&lt;span style="color: #a31515;"&gt;EntityContainer&lt;span style="color: blue;"&gt; &lt;span style="color: red;"&gt;Name&lt;span style="color: blue;"&gt;=&lt;/span&gt;"&lt;span style="color: blue;"&gt;ProjectModelStoreContainer&lt;/span&gt;"&lt;span style="color: blue;"&gt;&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="background: white;"&gt;&lt;span style="font-family: Consolas; color: blue; font-size: 8pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&lt;span style="color: #a31515;"&gt;EntitySet&lt;span style="color: blue;"&gt; &lt;span style="color: red;"&gt;Name&lt;span style="color: blue;"&gt;=&lt;/span&gt;"&lt;span style="color: blue;"&gt;Item&lt;/span&gt;"&lt;span style="color: blue;"&gt; &lt;span style="color: red;"&gt;EntityType&lt;span style="color: blue;"&gt;=&lt;/span&gt;"&lt;span style="color: blue;"&gt;ProjectModel.Store.Item&lt;/span&gt;"&lt;span style="color: blue;"&gt; &lt;span style="color: red;"&gt;store:Type&lt;span style="color: blue;"&gt;=&lt;/span&gt;"&lt;span style="color: blue;"&gt;Tables&lt;/span&gt;"&lt;span style="color: blue;"&gt; &lt;span style="color: red;"&gt;Schema&lt;span style="color: blue;"&gt;=&lt;/span&gt;"&lt;span style="color: blue;"&gt;dbo&lt;/span&gt;"&lt;span style="color: blue;"&gt; /&amp;gt;&lt;/span&gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="background: white;"&gt;&lt;span style="font-family: Consolas; color: blue; font-size: 8pt;"&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;lt;&lt;span style="color: #a31515;"&gt;EntitySet&lt;span style="color: blue;"&gt; &lt;span style="color: red;"&gt;Name&lt;span style="color: blue;"&gt;=&lt;/span&gt;"&lt;span style="color: blue;"&gt;ItemType&lt;/span&gt;"&lt;span style="color: blue;"&gt; &lt;span style="color: red;"&gt;EntityType&lt;span style="color: blue;"&gt;=&lt;/span&gt;"&lt;span style="color: blue;"&gt;ProjectModel.Store.ItemType&lt;/span&gt;"&lt;span style="color: blue;"&gt; &lt;span style="color: red;"&gt;store:Type&lt;span style="color: blue;"&gt;=&lt;/span&gt;"&lt;span style="color: blue;"&gt;Tables&lt;/span&gt;"&lt;span style="color: blue;"&gt; &lt;span style="color: red;"&gt;Schema&lt;span style="color: blue;"&gt;=&lt;/span&gt;"&lt;span style="color: blue;"&gt;dbo&lt;/span&gt;"&lt;span style="color: blue;"&gt; /&amp;gt; &lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/p&gt;
&lt;p style="background: white;"&gt;&lt;span style="font-family: Consolas; color: blue; font-size: 8pt;"&gt;&amp;hellip;&amp;hellip; &lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Dit heeft als resultaat dat het veld in het model ook echt een Identity veld wordt. Normaal kun je dit namelijk niet aanpassen in de properties:&lt;/p&gt;
&lt;p&gt;&lt;img src="http://weblogjanv/Lists/Photos/060910_1220_Nogsteedsge2.png" alt="" /&gt;&lt;/p&gt;
&lt;p&gt;Wel blijft het raar dat dit niet automatisch goed wordt geregeld. Hopelijk wordt dit wel opgelost in een servicepack of EF5.0.&lt;/p&gt;
&lt;/div&gt;</content>
  <ispublished>true</ispublished>
  <categories></categories>
  <comments></comments>
</post>