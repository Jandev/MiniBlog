<?xml version="1.0" encoding="utf-8"?>
<post>
  <title>'An unexpected error has occurred' met Sharepoint</title>
  <slug>an-unexpected-error-has-occurred-met-sharepoint</slug>
  <author>Jan</author>
  <pubDate>2008-05-15 20:44:00</pubDate>
  <lastModified>2014-04-25 12:06:08</lastModified>
  <content>&lt;div class="ExternalClass3DCDD700A8C242DAA06FCFBF237BDB72"&gt;Sinds kort ben ik me ook een beetje aan het verdiepen in Sharepoint (MOSS en WSS), dit moet ook wel, omdat we op het werk hier veel mee te maken hebben. Vandaag was ik bezig om een kleine testsite in elkaar te zetten met wat CMS functionaliteit. Dit lukte redelijk toen ik eenmaal het juiste template had gevonden en de site had klaar gezet. Nadat ik dat had gedaan wilde ik graag inhoud wijzigen en plaatsen op de website. De inhoud wijzigen was niet zo'n groot probleem, maar het plaatsen gaf een foutmeling. De foutmelding die ik kreeg te zien was &lt;em&gt;An unexpected error has occured&lt;/em&gt;, maar dan in het Nederlands, omdat ik met een Nederlands-talige MOSS installatie bezig was. Het was iets als &lt;em&gt;Een onbekende fout is opgetreden&lt;/em&gt; of iets in die richting. Daar kun je natuurlijk niet zoveel mee. Ook kon ik geen log terug vinden met de exacte foutmelding. Vervelende was ook dat gelijk de hele portal het niet meer deed en ik de browser opnieuw moest opstarten om de portal weer te kunnen zien. Als ontwikkelaar zie ik graag altijd gedetailleerde foutmeldingen, vandaar dat ik op zoek ben gegaan hoe ik die kon krijgen te zien. Wat blijkt, je kunt dit gewoon in de web.config van website doen. Open het betreffende web.config bestand en wijzig de volgende regels. Ten eerste moet worden vertaald naar En de custom errors moeten ook uitgeschakeld worden Nadat je dit hebt gedaan krijg je de juiste foutmelding te zien. De foutmelding die ik kreeg ging over de connectiestring naar de database. Het was iets als
&lt;div class="code"&gt;Unable to connect to SQL Server session database. The connection string (server='', database='SharedServices1_DB') was returned by an instance of the IPartitionResolver type 'Microsoft.Office.Server.Administration.SqlSessionStateResolver, Microsoft.Office.Server, Version=12.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c'.&lt;/div&gt;
Blijkbaar kon de database &lt;em&gt;SharedServices1_DB&lt;/em&gt; niet worden bereikt. Nadat ik op de database server was ingelogd zag ik de database wel gewoon staan. Omdat ik niet gelijk kon bedenken wat het probleem nou was ben ik op zoek gegaan naar een oplossing. Blijkbaar ben ik niet de enige die deze fout heeft gehad met een &lt;em&gt;Publishing portal&lt;/em&gt;, want er waren behoorlijk veel hits in Google te vinden. De oplossing bleek redelijk eenvoudig te zijn. Je moet de Sharepoint server &lt;em&gt;db_owner&lt;/em&gt; rechten geven op de &lt;em&gt;SharedServices1_DB&lt;/em&gt; database. Dit kan gewoon door een nieuwe login toe te voegen in SQL en de naam &lt;em&gt;DOMEIN\COMPUTERNAAM$&lt;/em&gt; in te vullen. Nu kun je aan dat account de juiste rechten geven op de database. In mijn geval zag ik de server al in het rijtje met logins staan en hoefde ik hem alleen nog maar eigenaar te maken van de Shared Services database. Toch vind ik het wel raar dat dit niet automatisch goed wordt geregeld bij het creeeren van de portal.&lt;/div&gt;</content>
  <ispublished>true</ispublished>
  <categories></categories>
  <comments></comments>
</post>