<?xml version="1.0" encoding="utf-8"?>
<post>
  <title>SharePoint and the Local Activation permission on DCOM objects on 2008R2</title>
  <slug>sharepoint-and-the-local-activation-permission-on-dcom-objects-on-2008r2</slug>
  <author>Jan</author>
  <pubDate>2011-04-15 17:42:45</pubDate>
  <lastModified>2014-04-25 12:06:07</lastModified>
  <content>&lt;p&gt;Another SharePoint farm installation, another problem.&lt;/p&gt; &lt;p&gt;I had to install SharePoint 2007 (don’t ask…..) on a Windows Server 2008R2 development machine. This is quite doable, as long as you install &lt;a href="https://msmvps.com/blogs/laflour/archive/2009/10/11/sharepoint-2007-on-windows-server-2008-r2.aspx"&gt;Service pack 2 of SharePoint&lt;/a&gt;. I figured it would be no problem and just another install, like I’ve done a gazillion times before.&lt;/p&gt; &lt;p&gt;Everything went quite well and because of the SSD disk, the installation didn’t take as long as I was used to. After the full installation was done I checked the Event Log to see if I maybe forgot something. Most of the time there’s something wrong with the Search services or something else which is easily forgotten. This time I saw a familiar message of some COM object not being able to start because of a permission error. A message similar as this one:&lt;/p&gt; &lt;p&gt;&lt;font face="Courier New"&gt;The application-specific permission settings do not grant Local Activation permission for the COM Server application with CLSID&lt;/font&gt;&lt;/p&gt; &lt;p&gt;&lt;font face="Courier New"&gt;{61738644-F196-11D0-9953-00C04FD919C1}&lt;/font&gt;&lt;/p&gt; &lt;p&gt;&lt;font face="Courier New"&gt;to the user &lt;strong&gt;[account and SID]&lt;/strong&gt;. This security permission can be modified using the Component Services administrative tool.&lt;/font&gt;&lt;/p&gt; &lt;p&gt;I’ve seen this a few times before and knew how to fix it.&lt;br&gt;Start up the &lt;em&gt;Component Services&lt;/em&gt; on the machine:&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_2.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_thumb.png" width="244" height="38"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Expand the treeview of the &lt;em&gt;Component Services&lt;/em&gt; on &lt;em&gt;My Computer&lt;/em&gt;:&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_4.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_thumb_1.png" width="244" height="61"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Now for the tricky part, search the component which has the same GUID as the error message has. This sounds easy, but the downside is you can’t sort the &lt;em&gt;Application ID&lt;/em&gt; column. Lucky for us you can also do a search in the registry for this GUID and it’ll tell you what the component’s name is.&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_6.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_thumb_2.png" width="244" height="111"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;As you can see it’s the &lt;em&gt;IIS WAMREG admin Service&lt;/em&gt;&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_8.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_thumb_3.png" width="244" height="57"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Knowing the name makes the search a bit easier as the list is sorted alphabetically.&lt;/p&gt; &lt;p&gt;Right-click on the component and view the properties of it. Navigating to the Security tab gives you some options, but as you can see all of these options are disabled on a Windows 2008R2 machine.&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_10.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_thumb_4.png" width="185" height="244"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Apparently the security model has changed a bit on Windows 2008R2 as these were still enabled on Windows 2008. Opening the Component Services as an Administrator makes no difference in what you will see.&lt;/p&gt; &lt;p&gt;Lucky I was able to find a &lt;a href="http://www.wictorwilen.se/Post/Fix-the-SharePoint-DCOM-10016-error-on-Windows-Server-2008-R2.aspx"&gt;solution&lt;/a&gt; for this problem. Quote:&lt;/p&gt; &lt;p&gt;&lt;em&gt;The reason for it being disabled is that this dialog is mapped to a key in the registry which theTrusted Installer is owner of and everyone else only has read permissions. The key used by the IIS WAMREG admin is:&lt;br&gt;HKEY_CLASSES_ROOT\AppID\{61738644-F196-11D0-9953-00C04FD919C1}&lt;/em&gt;&lt;/p&gt; &lt;p&gt;Well, that just means we have to change this registry key. Just navigate to this key again, select the permissions on the key:&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_12.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_thumb_5.png" width="244" height="194"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Click the &lt;em&gt;Advanced&lt;/em&gt; button and navigate to the &lt;em&gt;Owner&lt;/em&gt; tab:&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_14.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_thumb_6.png" width="244" height="89"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Select the &lt;em&gt;Administrators&lt;/em&gt; group and hit the &lt;em&gt;Apply&lt;/em&gt; button.&lt;/p&gt; &lt;p&gt;Now you are able to give the &lt;em&gt;Administrators&lt;/em&gt; group&lt;em&gt; Full Control&lt;/em&gt; on the registry key&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_16.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_thumb_7.png" width="201" height="244"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;After you’ve done that you need to restart the &lt;em&gt;Component Services&lt;/em&gt; and after doing so you’ll be able to change the &lt;em&gt;Launch and Activation Permissions&lt;/em&gt;&lt;/p&gt; &lt;p&gt;&lt;a href="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_18.png"&gt;&lt;img style="background-image: none; border-bottom: 0px; border-left: 0px; margin: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="image" border="0" alt="image" src="http://jan-v.nl/Media/Default/Windows-Live-Writer/f38116a253a9_10BE7/image_thumb_8.png" width="187" height="244"&gt;&lt;/a&gt;&lt;/p&gt; &lt;p&gt;Add the account which was mentioned in the event log entry and assign the &lt;em&gt;Local Launch&lt;/em&gt; and &lt;em&gt;Local Activation&lt;/em&gt; permissions to it.&lt;/p&gt; &lt;p&gt;Now you’re done!&lt;/p&gt;</content>
  <ispublished>true</ispublished>
  <categories></categories>
  <comments></comments>
</post>