<?xml version="1.0" encoding="utf-8"?>
<post>
  <title>Branding/styling het Sharepoint 2010 menu</title>
  <slug>branding-styling-het-sharepoint-2010-menu</slug>
  <author>Jan</author>
  <pubDate>2010-11-23 19:58:00</pubDate>
  <lastModified>2014-04-25 12:06:08</lastModified>
  <content>&lt;div class="ExternalClass86A851426F404824B28963799D3B571F"&gt; &lt;p&gt;Het standard menu van Sharepoint 2010 is op zich prima voor interne sites, echter bij een publieke website wil je hier wel het een en ander aan styling toepassen. Het standaard menu uit Sharepoint 2007 is gelukkig helemaal verbeterd en is tegenwoordig een stuk beter te stylen.&lt;/p&gt; &lt;p&gt;Het menu wordt gedefinieerd als een SharePoint:AspMenu. Dit is eigenlijk gewoon een asp:AspMenu met enkele uitbreidingen voor Sharepoint. Je kunt hier zelf niet van overerven, aangezien het een sealed class is. Er zijn her en der wel oplossingen te vinden waar men uiteindelijk toch in staat is geweest om de code van het menu over te erven. Wanneer er alleen wat gestyled moet worden is dat niet direct nodig, hoewel ik denk dat het toch wel handig kan zijn.&lt;/p&gt; &lt;p&gt;Omdat je eigenlijk werkt met een asp:AspMenu, kun je dus ook je eigen templates maken. Van onze designer had ik de opdracht gekregen dat het menu als hieronder moest worden gerenderd:&lt;/p&gt;&lt;pre class='brush: html'&gt;&amp;lt;ul class=""&amp;gt;
	&amp;lt;li class="selected_menu_item"&amp;gt;&amp;lt;a href="/default.aspx" class="link"&amp;gt;home&amp;lt;/a&amp;gt; &amp;lt;/li&amp;gt;
	&amp;lt;li&amp;gt;&amp;lt;a href="/Pagina/zwanger.aspx" class="link"&amp;gt;zwanger&amp;lt;/a&amp;gt; &amp;lt;/li&amp;gt;
	&amp;lt;li&amp;gt;&amp;lt;a href="/Pagina/baby.aspx" class="link"&amp;gt;baby&amp;lt;/a&amp;gt; &amp;lt;/li&amp;gt;
	&amp;lt;li&amp;gt;&amp;lt;a href="/Pagina/peuter.aspx" class="link"&amp;gt;peuter&amp;lt;/a&amp;gt; &amp;lt;/li&amp;gt;
	&amp;lt;li&amp;gt;&amp;lt;a href="/Pagina/schoolgaand_kind.aspx" class="link"&amp;gt;schoolgaand kind&amp;lt;/a&amp;gt; &amp;lt;/li&amp;gt;
	&amp;lt;li&amp;gt;&amp;lt;a href="/Pagina/puber.aspx" class="link"&amp;gt;puber&amp;lt;/a&amp;gt; &amp;lt;/li&amp;gt;
	&amp;lt;li&amp;gt;&amp;lt;a href="/Pagina/jong_volwassene.aspx" class="link"&amp;gt;jong volwassene&amp;lt;/a&amp;gt; &amp;lt;/li&amp;gt;
&amp;lt;/ul&amp;gt;
&lt;/pre&gt;
&lt;p&gt;Tijdens m'n ASP.NET tijd had ik al geleerd dat je in het asp:AspMenu gebruik kunt maken van het ItemTemplate blok. Het enige dat ik hoefde te doen is de header en footer (de UL-elementen) boven en onder het menu te plaatsen.&lt;/p&gt;
&lt;p&gt;Uiteindelijk is er deze code uit gekomen:&lt;/p&gt;&lt;pre class="brush: xml"&gt;&amp;lt;ul id="main_menu_ul" class=""&amp;gt;
	&amp;lt;sharepoint:aspmenu id="TopNavigationMenuV4" runat="server" enableviewstate="false"
		datasourceid="topSiteMap" accesskey="&amp;lt;%$Resources:wss,navigation_accesskey%&amp;gt;"
		usesimplerendering="true" useseparatecss="false" orientation="Horizontal" staticdisplaylevels="1"
		maximumdynamicdisplaylevels="1" skiplinktext="" cssclass="s4-tn"&amp;gt;
		&amp;lt;StaticSelectedStyle CssClass="selected_menu_item" /&amp;gt;
			&amp;lt;StaticItemTemplate&amp;gt;        
				&amp;lt;li&amp;gt;            
					&amp;lt;a href="&amp;lt;%# DataBinder.Eval(Container.DataItem, "DataPath") %&amp;gt;" class="link"&amp;gt;            
						&amp;lt;%# DataBinder.Eval(Container.DataItem, "Text") %&amp;gt;
					&amp;lt;/a&amp;gt;
					&amp;lt;/li&amp;gt;    
			&amp;lt;/StaticItemTemplate&amp;gt;
	&amp;lt;/sharepoint:aspmenu&amp;gt;
	&amp;lt;sharepoint:delegatecontrol runat="server" controlid="TopNavigationDataSource" id="topNavigationDelegate"&amp;gt;    
		&amp;lt;Template_Controls&amp;gt;        
			&amp;lt;asp:SiteMapDataSource ShowStartingNode="False" SiteMapProvider="SPNavigationProvider"
			id="topSiteMap" runat="server" StartingNodeUrl="sid:1002"/&amp;gt;        
		&amp;lt;/Template_Controls&amp;gt;
	&amp;lt;/sharepoint:delegatecontrol&amp;gt;
&amp;lt;/ul&amp;gt;
&lt;/pre&gt;
&lt;p&gt;In principe is dit precies wat ik wilde. Alle menu elementen in een li-element stoppen en dat alles in een ul-element.&lt;br&gt;Bij het bekijken van de pagina leek alles ook goed te gaan, afgezien van een jQuery functie. Bij nadere inspectie van de broncode kwam dit omdat het Sharepoint:AspMenu zelf allerlei elementen aanmaakte met 'nuttige' informatie, hier kon de jQuery functie niet tegen. Omdat het ook niet netjes is om een verschillende elementen binnen een ul-element te hebben moest er dus iets anders worden ontwikkeld.&lt;/p&gt;
&lt;p&gt;Omdat je niet een header- en footer template kunt definiëren met een AspMenu kon ik dit eigenlijk al niet meer gebruiken. Gelukkig bestaan er meerdere ASP.NET controls waar gebruik van kan worden gemaakt wanneer je een datasource hebt, zoals een asp:Repeater.&lt;/p&gt;
&lt;p&gt;Met een asp:Repeater kun je wel een header- en footertemplate definieren en levert geen onnodige tabellen of andere elementen op. Nadeel van de repeater is wel dat het lastig is om meerdere niveaus te definiëren.&lt;/p&gt;
&lt;p&gt;In dit specifieke geval is het niet zo'n enorm probleem dat er maar 1 niveau kan worden gebruikt, omdat er meerdere menu's onder elkaar komen te staan, welke dus allemaal hun eigen asp:Repeater kunnen gebruiken met een eigen datasource.&lt;/p&gt;
&lt;p&gt;De code die ik gebruik voor het vullen van het menu is als volgt:&lt;/p&gt;&lt;pre class='brush: html'&gt;&amp;lt;asp:Repeater ID="TopMenu" runat="server" DataSourceID="cjgSiteMap"&amp;gt;
	&amp;lt;HeaderTemplate&amp;gt;
		&amp;lt;ul id="main_menu_ul" class=""&amp;gt;
	&amp;lt;/HeaderTemplate&amp;gt;
	&amp;lt;ItemTemplate&amp;gt;
		&amp;lt;li&amp;gt;&amp;lt;a href="&amp;lt;%# Eval("Url")%&amp;gt;" class="link"&amp;gt;
			&amp;lt;%# Eval("Title")%&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/li&amp;gt;
	&amp;lt;/ItemTemplate&amp;gt;
	&amp;lt;FooterTemplate&amp;gt;
		&amp;lt;/ul&amp;gt;
	&amp;lt;/FooterTemplate&amp;gt;
&amp;lt;/asp:Repeater&amp;gt;
&amp;lt;asp:SiteMapDataSource SiteMapProvider="CombinedNavSiteMapProvider" ShowStartingNode="false"
	StartFromCurrentNode="false" StartingNodeOffset="0" StartingNodeUrl="sid:1002"
	EnableViewState="true" ID="cjgSiteMap" runat="server" /&amp;gt;
&lt;/pre&gt;
&lt;p&gt;Bij de submenu's gebruik ik gewoon een StartingNodeOffset die hoger is, of een van de andere navigation providers welke beschikbaar zijn binnen Sharepoint, een overzicht van 2007 is hier te vinden: &lt;a href="http://ktskumar.wordpress.com/2008/04/14/sharepoint-navigation-providers-part-1/"&gt;http://ktskumar.wordpress.com/2008/04/14/sharepoint-navigation-providers-part-1/&lt;/a&gt; (deze werken over het algemeen ook in Sharepoint 2010).&lt;/p&gt;
&lt;p&gt;Het resultaat is het onderstaande voorbeeld:&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="http://www.jan-v.nl/Lists/Photos/112310_1857_Brandingsty1.png"&gt;&lt;/p&gt;
&lt;p&gt;Ik ben nu blij dat het AspMenu niet naar behoren werkte, aangezien er nu een veel mooiere oplossing is geïmplementeerd voor deze website.&lt;/p&gt;&lt;/div&gt;</content>
  <ispublished>true</ispublished>
  <categories></categories>
  <comments></comments>
</post>