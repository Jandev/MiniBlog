<?xml version="1.0" encoding="utf-8"?>
<post>
  <title>Disable hibernate via registry when nothing else works</title>
  <slug>disable-hibernate-via-registry-when-nothing-else-works</slug>
  <author>Jan</author>
  <pubDate>2012-04-18 17:29:22</pubDate>
  <lastModified>2014-04-25 12:06:07</lastModified>
  <content>&lt;p&gt;One of my development machines has a dual-boot to a 2008R2 environment via the &lt;a href="http://blogs.msdn.com/b/knom/archive/2009/04/07/windows-7-vhd-boot-setup-guideline.aspx"&gt;Boot from VHD&lt;/a&gt; technique. This works all quite well, but today I received the message the C-drive was getting a bit full. Most of the time this isn’t much of a problem, just delete some log files, do a disk cleanup, empty the recycle bin and maybe use &lt;a href="http://www.sixty-five.cc/sm/"&gt;SpaceMonger&lt;/a&gt; to see what’s using up the rest of the space. Also, most of the time there’s about 500MB left free on the disk. &lt;/p&gt; &lt;p&gt;Today was different. Visual Studio wasn’t able to build my solution due to insufficient free disk space on the C-drive. Upon further inspection I saw a total of 0 free bytes were available. After doing the regular cleanup I had a stunning 119MB free on my C-drive. SpaceMonger had already shown me there was a hibernate file on the C-drive which took up 8GB. Quite strange considering I had turned off all of my hibernate options in Windows (I really don’t like hibernating). Also, this hibernate file doesn’t get generated when booting the machine in VMWare Player or VMWare Workstation.&lt;/p&gt; &lt;p&gt;All of my internet sources say you have to run &lt;font face="Courier New"&gt;powercfg –h off&lt;/font&gt; and reboot to completely remove the file. Problem with that is it gave (and still gives) me the following error:&lt;/p&gt; &lt;p&gt;“An internal system component has disabled hibernation”&lt;/p&gt; &lt;p&gt;&lt;img alt="image" src="http://sundium.files.wordpress.com/2011/05/image_thumb.png?w=584&amp;amp;h=121"&gt;&lt;/p&gt; &lt;p&gt;Microsoft also has a &lt;a href="http://support.microsoft.com/kb/920730"&gt;Fix it solution&lt;/a&gt; for it, but that didn’t do the trick for me either. Also &lt;a href="http://www.emptyloop.com/unlocker/"&gt;Unlocker&lt;/a&gt; couldn’t do a lot with this file.&lt;/p&gt; &lt;p&gt;After searching for a few hours on this subject I finally &lt;a href="http://sundium.wordpress.com/2011/05/25/an-internal-system-component-has-disabled-hibernation/"&gt;stumbled upon the weblog of Jian Sun&lt;/a&gt;.&lt;/p&gt; &lt;p&gt;The solution to the problem is to disable the hibernation via the registry. The hibernate options can be found in the following path:&lt;/p&gt; &lt;p&gt;&lt;font face="Courier New"&gt;HKEY_LOCAL_MACHINE\SYSTEM\CurrentCongtrolSet\Control\Power\&lt;/font&gt;&lt;/p&gt; &lt;p&gt;Over here you can find the &lt;font face="Courier New"&gt;HiberFileSizePercent&lt;/font&gt; and &lt;font face="Courier New"&gt;HibernateEnabled&lt;/font&gt; keys. The blog of Jian Sun says you need to change the &lt;font face="Courier New"&gt;HibernateEnabled&lt;/font&gt; from 1 to 0 to disable the hibernation (and reboot of course). This didn’t do the trick for me, so I started changing the &lt;font face="Courier New"&gt;HiberFileSizePercent&lt;/font&gt; key. It was saying 100 when I started, but I’ve changed it to 2 now (so I don’t confuse it with a &lt;em&gt;bit&lt;/em&gt; later on). After rebooting the filesize of hiberfil.sys was about 160MB. This really solved my disk space problem for now.&lt;/p&gt; &lt;p&gt;So, if you want to get rid of your hibernate file on the C-drive and aren’t able to get this working via the normal protocol, do some registry changes.&lt;/p&gt;</content>
  <ispublished>true</ispublished>
  <categories></categories>
  <comments></comments>
</post>